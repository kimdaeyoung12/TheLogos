{{ define "main" }}
{{- $publishDate := .PublishDate | default .Date -}}
{{- $lastmod := .Lastmod | default $publishDate -}}
{{- $authorName := .Params.author | default (.Site.Params.author | default "DaeYoung Kim") -}}
{{- $scratch := newScratch -}}
{{- $schema := dict
"@context" "https://schema.org"
"@type" "BlogPosting"
"mainEntityOfPage" (dict "@type" "WebPage" "@id" .Permalink)
"headline" .Title
"datePublished" ($publishDate.Format "2006-01-02")
"dateModified" ($lastmod.Format "2006-01-02")
"author" (dict "@type" "Person" "name" $authorName)
"url" .Permalink
"wordCount" .WordCount
"timeRequired" (printf "PT%dM" .ReadingTime)
-}}
{{- $scratch.Set "schema" $schema -}}
{{- with .Params.categories }}
{{- $scratch.Set "schema" (merge ($scratch.Get "schema") (dict "articleSection" (delimit . ", "))) -}}
{{- end -}}
{{- $description := .Params.description | default (.Summary | plainify) -}}
{{- if $description -}}
{{- $scratch.Set "schema" (merge ($scratch.Get "schema") (dict "description" $description)) -}}
{{- end -}}
{{- $publisherLogo := "/images/avatar.png" | absURL -}}
{{- with .Site.Params.publisherLogo -}}
{{- $publisherLogo = . | absURL -}}
{{- end -}}
{{- $publisher := dict
"@type" "Organization"
"name" (.Site.Title | default $authorName)
"logo" (dict "@type" "ImageObject" "url" $publisherLogo)
-}}
{{- $scratch.Set "schema" (merge ($scratch.Get "schema") (dict "publisher" $publisher)) -}}
{{- $scratch.Set "images" (slice) -}}
{{- with .Params.images -}}
{{- range . -}}
{{- $scratch.Set "images" (append ($scratch.Get "images") (absURL .)) -}}
{{- end -}}
{{- end -}}
{{- if and (eq (len ($scratch.Get "images")) 0) .Params.image -}}
{{- $scratch.Set "images" (slice (.Params.image | absURL)) -}}
{{- end -}}
{{- if and (eq (len ($scratch.Get "images")) 0) .Params.featuredImage -}}
{{- $scratch.Set "images" (slice (.Params.featuredImage | absURL)) -}}
{{- end -}}
{{- if gt (len ($scratch.Get "images")) 0 -}}
{{- $scratch.Set "schema" (merge ($scratch.Get "schema") (dict "image" ($scratch.Get "images"))) -}}
{{- end -}}
{{- /* Add keywords from tags */ -}}
{{- with .Params.tags -}}
{{- $scratch.Set "schema" (merge ($scratch.Get "schema") (dict "keywords" (delimit . ", "))) -}}
{{- end -}}
{{- /* Add mentions for referenced entities - extensible via front matter */ -}}
{{- with .Params.mentions -}}
{{- $mentionsList := slice -}}
{{- range . -}}
{{- $mention := dict "@type" "Thing" "name" . -}}
{{- $mentionsList = $mentionsList | append $mention -}}
{{- end -}}
{{- $scratch.Set "schema" (merge ($scratch.Get "schema") (dict "mentions" $mentionsList)) -}}
{{- end -}}
<script type="application/ld+json">
{{ ($scratch.Get "schema") | jsonify }}
</script>
{{- /* BreadcrumbList Schema for site hierarchy */ -}}
{{- $breadcrumbItems := slice -}}
{{- $breadcrumbItems = $breadcrumbItems | append (dict "@type" "ListItem" "position" 1 "name" "Home" "item"
(.Site.BaseURL | default "https://thelogos.dev/")) -}}
{{- with .CurrentSection -}}
{{- if ne .Title .Site.Title -}}
{{- $breadcrumbItems = $breadcrumbItems | append (dict "@type" "ListItem" "position" 2 "name" .Title "item" .Permalink)
-}}
{{- end -}}
{{- end -}}
{{- $breadcrumbItems = $breadcrumbItems | append (dict "@type" "ListItem" "position" (add (len $breadcrumbItems) 1)
"name" .Title "item" .Permalink) -}}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": {{ $breadcrumbItems | jsonify }}
}
</script>
<article class="article" itemscope itemtype="https://schema.org/BlogPosting">
    <!-- Article Header -->
    <header class="article-header">
        <div class="header-container">
            <!-- Category Logic -->
            {{ $category := "other" }}
            {{ if .Params.categories }}
            {{ $category = index .Params.categories 0 | lower }}
            {{ end }}

            {{ $categoryData := index .Site.Data.categories $category }}
            {{ if not $categoryData }}
            {{ $categoryData = index .Site.Data.categories "other" }}
            {{ end }}

            {{ $catName := $categoryData.name | default "Í∏∞ÌÉÄ" }}
            {{ $catIcon := $categoryData.icon | default "üìù" }}
            {{ $catColor := $categoryData.color | default "#9ca3af" }}

            <div class="article-category">
                <span class="category-badge"
                    style="background-color: {{ $catColor }}; color: #ffffff; padding: 6px 14px; border-radius: 6px; display: inline-block; font-weight: 700; text-shadow: 0 1px 2px rgba(0,0,0,0.2);">
                    {{ $catIcon }} {{ $catName }}
                </span>
            </div>
            <!-- End Category Logic -->

            <!-- Title -->
            <h1 class="article-title" itemprop="headline">{{ .Title }}</h1>

            <!-- Meta Info -->
            <div class="article-meta">
                <div class="author-info">
                    <img src="/images/avatar.png" alt="Author" class="author-avatar"
                        onerror="this.style.display='none'">
                    <span class="author-name">{{ .Site.Params.author | default "DaeYoung Kim" }}</span>
                </div>
                <div class="meta-divider">¬∑</div>
                <time datetime="{{ .Date.Format " 2006-01-02" }}">{{ .Date.Format "2006ÎÖÑ 1Ïõî 2Ïùº" }}</time>
                <div class="meta-divider">¬∑</div>
                <span class="reading-time">{{ .ReadingTime }}Î∂Ñ ÏùΩÍ∏∞</span>
                <div class="meta-divider">¬∑</div>
                <span class="word-count">{{ .WordCount }}Ïûê</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="article-container">
        <div class="article-content" itemprop="articleBody">
            {{ .Content }}
        </div>
    </div>

    <!-- Article Footer -->
    <footer class="article-footer">
        <!-- Tags -->
        {{ with .Params.tags }}
        <div class="article-tags">
            <h3 class="section-title">ÌÉúÍ∑∏</h3>
            <div class="tag-list">
                {{ range . }}
                <a href="{{ " tags/" | absURL }}{{ . | urlize }}" class="tag-item">#{{ . }}</a>
                {{ end }}
            </div>
        </div>
        {{ end }}

        <!-- Share Section -->
        <div class="share-section">
            <h3 class="section-title">Í≥µÏú†ÌïòÍ∏∞</h3>
            <div class="share-buttons">
                <button class="share-btn" data-share="twitter" title="TwitterÎ°ú Í≥µÏú†">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z" />
                    </svg>
                    <span>Twitter</span>
                </button>

                <button class="share-btn" data-share="facebook" title="FacebookÏúºÎ°ú Í≥µÏú†">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
                    </svg>
                    <span>Facebook</span>
                </button>

                <button class="share-btn" data-share="link" title="ÎßÅÌÅ¨ Î≥µÏÇ¨">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                    <span>ÎßÅÌÅ¨ Î≥µÏÇ¨</span>
                </button>
            </div>
        </div>

        <!-- Post Navigation -->
        {{ if or .NextInSection .PrevInSection }}
        <nav class="post-nav">
            {{ with .PrevInSection }}
            <a href="{{ .RelPermalink }}" class="nav-item prev">
                <span class="nav-label">Ïù¥Ï†Ñ Í∏Ä</span>
                <span class="nav-title">{{ .Title }}</span>
            </a>
            {{ end }}

            {{ with .NextInSection }}
            <a href="{{ .RelPermalink }}" class="nav-item next">
                <span class="nav-label">Îã§Ïùå Í∏Ä</span>
                <span class="nav-title">{{ .Title }}</span>
            </a>
            {{ end }}
        </nav>
        {{ end }}
    </footer>
</article>


{{- /* Include Single Post CSS/JS */ -}}
{{- $single_css := resources.Get "css/single.css" | minify | fingerprint -}}
<link rel="stylesheet" href="{{ $single_css.Permalink }}" integrity="{{ $single_css.Data.Integrity }}">

{{- $single_js := resources.Get "js/single.js" | minify | fingerprint -}}
<script src="{{ $single_js.Permalink }}" integrity="{{ $single_js.Data.Integrity }}"></script>
{{ end }}