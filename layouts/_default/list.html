{{ define "main" }}
<section class="posts-list-section">
    <div class="container">
        <header class="page-header">
            <h1 class="page-title">Posts</h1>
            <p class="page-description">ì¢…êµ, ì² í•™, ê³µí•™, ê¸€ì“°ê¸°ì— ëŒ€í•œ ìƒê°ê³¼ í†µì°°ì„ ë‚˜ëˆ•ë‹ˆë‹¤</p>

            <!-- Unified Filter Buttons -->
            <div class="category-filters">
                <button class="filter-btn active" data-category="all">
                    <span class="icon">ğŸ“š</span>
                    <span>ì „ì²´</span>
                </button>
                <button class="filter-btn" data-category="religion">
                    <span class="icon">ğŸ•Šï¸</span>
                    <span>ì¢…êµ</span>
                </button>
                <button class="filter-btn" data-category="philosophy">
                    <span class="icon">ğŸ¤”</span>
                    <span>ì² í•™</span>
                </button>
                <button class="filter-btn" data-category="engineering">
                    <span class="icon">âš™ï¸</span>
                    <span>ê³µí•™</span>
                </button>
                <button class="filter-btn" data-category="writing">
                    <span class="icon">âœï¸</span>
                    <span>ê¸€ì“°ê¸°</span>
                </button>
            </div>
        </header>

        <!-- Unified Posts Grid -->
        <div class="posts-grid">
            {{ $posts := where .Site.RegularPages "Section" "posts" }}
            {{ range $posts.ByDate.Reverse }}

            {{/* Determine Category Metadata */}}
            {{ $category := "other" }}
            {{ if .Params.categories }}
            {{ $category = index .Params.categories 0 | lower }}
            {{ end }}

            {{ $categoryData := index .Site.Data.categories $category }}
            {{ if not $categoryData }}
            {{ $categoryData = index .Site.Data.categories "other" }}
            {{ end }}

            {{ $catName := $categoryData.name | default "ê¸°íƒ€" }}
            {{ $catIcon := $categoryData.icon | default "ğŸ“" }}
            {{ $catColor := $categoryData.color | default "#9ca3af" }}

            <article class="post-card" data-category="{{ $category }}">
                <div class="post-card-content">
                    <div class="post-meta-top">
                        <!-- Category Badge -->
                        <span class="category-badge"
                            style="background-color: {{ $catColor }}; color: #ffffff; padding: 4px 10px; border-radius: 12px; font-size: 0.8rem; font-weight: 700; text-shadow: 0 1px 2px rgba(0,0,0,0.2);">
                            {{ $catIcon }} {{ $catName }}
                        </span>
                        <span class="meta-dot">Â·</span>
                        <span class="post-date-text">{{ .Date.Format "Jan 2, 2006" }}</span>
                    </div>

                    <h4 class="post-title">
                        <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                    </h4>

                    <p class="post-excerpt">
                        {{ .Summary | plainify | truncate 140 }}
                    </p>

                    <div class="post-footer-simple">
                        <a href="{{ .RelPermalink }}" class="read-more-simple">Read</a>
                    </div>
                </div>
            </article>
            {{ end }}
        </div>

        {{ if not $posts }}
        <p class="no-posts" style="text-align: center; margin-top: 40px; color: var(--text-secondary);">ì•„ì§ ì‘ì„±ëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.
        </p>
        {{ end }}
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const filterBtns = document.querySelectorAll('.filter-btn');
        const cards = document.querySelectorAll('.post-card');

        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // Active State Toggle
                filterBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                const filter = btn.getAttribute('data-category');

                cards.forEach(card => {
                    const cardCategory = card.getAttribute('data-category');

                    if (filter === 'all' || cardCategory === filter) {
                        card.style.display = 'flex';
                        setTimeout(() => card.style.opacity = '1', 50);
                    } else {
                        card.style.opacity = '0';
                        setTimeout(() => card.style.display = 'none', 300);
                    }
                });
            });
        });
    });
</script>
{{ end }}